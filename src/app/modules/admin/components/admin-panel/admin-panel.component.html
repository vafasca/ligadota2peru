<div class="admin-panel-container">
  <!-- Sidebar -->
  <div class="sidebar">
    <div class="logo-container">
      <img src="../../../../../assets/logo_tournament.jpg" alt="Tournament Platform Logo" class="logo">
      <h2>Panel de Moderador</h2>
    </div>
    
    <nav class="admin-nav">
      <ul>
        <li [class.active]="activeTab === 'dashboard'" (click)="switchTab('dashboard')">
          <i class="fas fa-tachometer-alt"></i> Dashboard
        </li>
        <li [class.active]="activeTab === 'tournaments'" (click)="switchTab('tournaments')">
          <i class="fas fa-trophy"></i> Torneos
        </li>
        <li [class.active]="activeTab === 'matches'" (click)="switchTab('matches')">
          <i class="fas fa-gamepad"></i> Partidos
        </li>
        <li [class.active]="activeTab === 'users'" (click)="switchTab('users')">
          <i class="fas fa-users"></i> Usuarios
        </li>
        <li [class.active]="activeTab === 'reports'" (click)="switchTab('reports')">
          <i class="fas fa-flag"></i> Reportes
        </li>
      </ul>
      
      <button class="create-tournament-btn" (click)="openTournamentModal()">
        <i class="fas fa-plus-circle"></i> Crear Torneo
      </button>
    </nav>
  </div>
  
  <!-- Main Content -->
  <div class="main-content">
    <header class="admin-header">
      <h1>{{ getHeaderTitle() }}</h1>
      <div class="user-controls">
        <span class="username">Moderador</span>
        <div class="user-avatar">
          <i class="fas fa-user-shield"></i>
        </div>
      </div>
    </header>
    
    <div class="content-area">
      <!-- Dashboard Tab -->
      <div *ngIf="activeTab === 'dashboard'" class="dashboard-tab">
        <div class="stats-cards">
          <div class="stat-card" *ngFor="let stat of stats" [ngClass]="'stat-' + stat.id">
            <div class="stat-icon">
              <i [class]="stat.icon"></i>
            </div>
            <div class="stat-info">
              <h3>{{ stat.title }}</h3>
              <p class="stat-value">{{ stat.value }}</p>
            </div>
          </div>
        </div>
        
        <div class="recent-activity">
          <h2>Actividad Reciente</h2>
          <div class="activity-list">
            <div class="activity-item" *ngFor="let activity of recentActivities">
              <div class="activity-icon" [ngClass]="'bg-' + activity.type">
                <i [class]="activity.icon"></i>
              </div>
              <div class="activity-details">
                <p matTooltip="{{activity.description}}" [matTooltipDisabled]="activity.description.length <= 60">{{activity.description}}</p>
                <span class="activity-time">{{activity.time}}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Tournaments Tab -->
      <div *ngIf="activeTab === 'tournaments'" class="tournaments-tab">
        <div class="section-header">
          <h2>Torneos Recientes</h2>
          <button class="action-button" (click)="openTournamentModal()">
            <i class="fas fa-plus"></i> Nuevo Torneo
          </button>
        </div>
        
        <div class="table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>Nombre</th>
                <th>Estado</th>
                <th>Equipos</th>
                <th>Fecha de Inicio</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let tournament of recentTournaments">
                <td matTooltip="{{tournament.name}}" [matTooltipDisabled]="tournament.name.length <= 20">{{ tournament.name }}</td>
                <td><span class="status-badge" [class]="getStatusClass(tournament.status)">{{ tournament.status }}</span></td>
                <td>{{ tournament.currentTeams }}</td>
                <td>{{ tournament.startDate | date:'mediumDate' }}</td>
                <td>
                  <button class="table-action" matTooltip="Editar"><i class="fas fa-edit"></i></button>
                  <button class="table-action" matTooltip="Configurar"><i class="fas fa-cog"></i></button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      
      <!-- Users Tab -->
      <div *ngIf="activeTab === 'users'" class="users-tab">
        <div class="user-division-tabs">
          <button [class.active]="activeUserTab === 'division1'" (click)="activeUserTab = 'division1'">División 1</button>
          <button [class.active]="activeUserTab === 'division2'" (click)="activeUserTab = 'division2'">División 2</button>
          <button [class.active]="activeUserTab === 'moderators'" (click)="activeUserTab = 'moderators'">Moderadores</button>
        </div>
        
        <!-- Division 1 Users -->
        <div *ngIf="activeUserTab === 'division1'" class="user-list">
          <div class="section-header">
            <h2>Jugadores División 1</h2>
            <button class="action-button">
              <i class="fas fa-plus"></i> Agregar Jugador
            </button>
          </div>
          
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Usuario</th>
                  <th>Email</th>
                  <th>Estado</th>
                  <th>Último Login</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let user of division1Users">
                  <td matTooltip="{{user.username}}" [matTooltipDisabled]="user.username.length <= 15">{{ user.username }}</td>
                  <td matTooltip="{{user.email}}" [matTooltipDisabled]="user.email.length <= 20">{{ user.email }}</td>
                  <td><span class="status-badge" [class]="getStatusClass(user.status)">{{ user.status }}</span></td>
                  <td>{{ user.lastLogin | date:'short' }}</td>
                  <td>
                    <button class="table-action" matTooltip="Editar"><i class="fas fa-edit"></i></button>
                    <button class="table-action warning" matTooltip="Suspender"><i class="fas fa-ban"></i></button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        
        <!-- Division 2 Users -->
        <div *ngIf="activeUserTab === 'division2'" class="user-list">
          <div class="section-header">
            <h2>Jugadores División 2</h2>
            <button class="action-button">
              <i class="fas fa-plus"></i> Agregar Jugador
            </button>
          </div>
          
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Usuario</th>
                  <th>Email</th>
                  <th>Estado</th>
                  <th>Último Login</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let user of division2Users">
                  <td matTooltip="{{user.username}}" [matTooltipDisabled]="user.username.length <= 15">{{ user.username }}</td>
                  <td matTooltip="{{user.email}}" [matTooltipDisabled]="user.email.length <= 20">{{ user.email }}</td>
                  <td><span class="status-badge" [class]="getStatusClass(user.status)">{{ user.status }}</span></td>
                  <td>{{ user.lastLogin | date:'short' }}</td>
                  <td>
                    <button class="table-action" matTooltip="Editar"><i class="fas fa-edit"></i></button>
                    <button class="table-action warning" matTooltip="Suspender"><i class="fas fa-ban"></i></button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        
        <!-- Moderators -->
        <div *ngIf="activeUserTab === 'moderators'" class="user-list">
          <div class="section-header">
            <h2>Moderadores</h2>
            <button class="action-button">
              <i class="fas fa-plus"></i> Agregar Moderador
            </button>
          </div>
          
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Usuario</th>
                  <th>Email</th>
                  <th>Rol</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let mod of moderators">
                  <td matTooltip="{{mod.username}}" [matTooltipDisabled]="mod.username.length <= 15">{{ mod.username }}</td>
                  <td matTooltip="{{mod.email}}" [matTooltipDisabled]="mod.email.length <= 20">{{ mod.email }}</td>
                  <td>{{ mod.role }}</td>
                  <td>
                    <button class="table-action" matTooltip="Editar"><i class="fas fa-edit"></i></button>
                    <button class="table-action warning" matTooltip="Eliminar"><i class="fas fa-trash-alt"></i></button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      
      <!-- Matches Tab -->
      <div *ngIf="activeTab === 'matches'" class="matches-tab">
        <div class="section-header">
          <h2>Partidos Pendientes</h2>
          <button class="action-button">
            <i class="fas fa-plus"></i> Programar Partido
          </button>
        </div>
        
        <div class="matches-grid">
          <div *ngFor="let match of pendingMatches" class="match-card">
            <div class="match-teams">
              <div class="team">
                <div class="team-logo">
                  <i class="fas fa-users"></i>
                </div>
                <span class="team-name" matTooltip="{{match.teamA}}" [matTooltipDisabled]="match.teamA.length <= 15">{{ match.teamA }}</span>
              </div>
              <div class="vs-circle">VS</div>
              <div class="team">
                <div class="team-logo">
                  <i class="fas fa-users"></i>
                </div>
                <span class="team-name" matTooltip="{{match.teamB}}" [matTooltipDisabled]="match.teamB.length <= 15">{{ match.teamB }}</span>
              </div>
            </div>
            <div class="match-details">
              <p><i class="fas fa-trophy"></i> {{ match.tournament }}</p>
              <p><i class="far fa-clock"></i> {{ match.scheduledTime | date:'medium' }}</p>
            </div>
            <div class="match-actions">
              <button class="action-button small" matTooltip="Administrar partido">Administrar</button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Reports Tab -->
      <div *ngIf="activeTab === 'reports'" class="reports-tab">
        <div class="section-header">
          <h2>Reportes de Usuarios</h2>
          <button class="action-button">
            <i class="fas fa-filter"></i> Filtrar
          </button>
        </div>
        
        <div class="table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>Usuario</th>
                <th>Razón</th>
                <th>Reportado por</th>
                <th>Fecha</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let report of reportedUsers">
                <td matTooltip="{{report.username}}" [matTooltipDisabled]="report.username.length <= 15">{{ report.username }}</td>
                <td matTooltip="{{report.reason}}" [matTooltipDisabled]="report.reason.length <= 25">{{ report.reason }}</td>
                <td matTooltip="{{report.reportedBy}}" [matTooltipDisabled]="report.reportedBy.length <= 15">{{ report.reportedBy }}</td>
                <td>{{ report.date | date:'shortDate' }}</td>
                <td>
                  <button class="table-action" matTooltip="Ver detalles"><i class="fas fa-eye"></i></button>
                  <button class="table-action warning" matTooltip="Tomar acción"><i class="fas fa-ban"></i></button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Create Tournament Modal -->
  <div *ngIf="showTournamentModal" class="modal-overlay">
    <div class="modal-container">
      <div class="modal-header">
        <h2>Crear Nuevo Torneo</h2>
        <button class="close-button" (click)="closeTournamentModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <form [formGroup]="tournamentForm" (ngSubmit)="submitTournamentForm()" class="tournament-form">
        <div class="form-group">
          <label for="tournament-name">Nombre del Torneo</label>
          <input type="text" id="tournament-name" formControlName="name" placeholder="Ej: Dota 2 Championship">
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="game">Juego</label>
            <select id="game" formControlName="game">
              <option value="Dota 2">Dota 2</option>
              <!-- <option value="CS:GO">CS:GO</option>
              <option value="Valorant">Valorant</option> -->
            </select>
          </div>
          
          <div class="form-group">
            <label for="format">Formato</label>
            <select id="format" formControlName="format">
              <option value="Single Elimination">Eliminación Simple</option>
              <option value="Double Elimination">Eliminación Doble</option>
              <option value="Round Robin">Round Robin</option>
            </select>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="max-teams">Máx. Equipos</label>
            <input type="number" id="max-teams" formControlName="maxTeams" min="4" max="32">
          </div>
          
          <div class="form-group">
            <label for="start-date">Fecha de Inicio</label>
            <input type="date" id="start-date" formControlName="startDate">
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="prize-pool">Premio (opcional)</label>
            <input type="text" id="prize-pool" formControlName="prizePool" placeholder="Ej: $1000">
          </div>
          
          <div class="form-group">
            <label for="entry-fee">Cuota de Entrada</label>
            <input type="number" id="entry-fee" formControlName="entryFee" min="0">
          </div>
        </div>
        
        <div class="form-group">
          <label for="rules">Reglas (opcional)</label>
          <textarea id="rules" formControlName="rules" rows="4" placeholder="Describe las reglas específicas del torneo..."></textarea>
        </div>
        
        <div class="form-actions">
          <button type="button" class="cancel-button" (click)="closeTournamentModal()">Cancelar</button>
          <button type="submit" class="submit-button" [disabled]="!tournamentForm.valid">Crear Torneo</button>
        </div>
      </form>
    </div>
  </div>
</div>